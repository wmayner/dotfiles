# ~/.config/aerospace/aerospace.toml

start-at-login = true

# ---------- Auto mode switcher ----------
after-startup-command = 'exec-and-forget ${BASH_PATH} auto-switch-modes.sh'

# ---------- Exec env ----------
[exec.env-vars]
PATH = '${HOME}/dotfiles/aerospace/scripts:${PATH}'
BASH_PATH = '/usr/local/bin/bash'  # ensure we use Homebrew Bash for all our scripts

# ---------- Floating only ----------
[[on-window-detected]]
run = "layout floating"

# ---------- Workspace → monitor assignment ----------
# Keep your L/C/R mapping for desktop mode. Use array patterns so they still land
# somewhere sensible if you only have 1 monitor connected.
[workspace-to-monitor-force-assignment]
# L/C/R pool (desktop mode uses these)
"1L" = 1
"1C" = 2
"1R" = 3
"2L" = 1
"2C" = 2
"2R" = 3
"3L" = 1
"3C" = 2
"3R" = 3
"4L" = 1
"4C" = 2
"4R" = 3
"5L" = 1
"5C" = 2
"5R" = 3
"6L" = 1
"6C" = 2
"6R" = 3
"7L" = 1
"7C" = 2
"7R" = 3
"8L" = 1
"8C" = 2
"8R" = 3
"9L" = 1
"9C" = 2
"9R" = 3
"10L" = 1
"10C" = 2
"10R" = 3

# Pure numeric pool for main mode. Always on the main (single) display.
1 = 'main'
2 = 'main'
3 = 'main'
4 = 'main'
5 = 'main'
6 = 'main'
7 = 'main'
8 = 'main'
9 = 'main'
10 = 'main'

# ---------- Binding modes ----------
# We define two modes:
# - 'main' (single-monitor)
# - 'desktop' (unified L/C/R across 3 monitors)

# ===== Main (single-monitor) mode =====
[mode.main.binding]

# Save/restore layout
shift-cmd-ctrl-s = 'exec-and-forget ${BASH_PATH} aerospace-save-restore.sh save'
shift-cmd-ctrl-r = 'exec-and-forget ${BASH_PATH} aerospace-save-restore.sh restore'

# Simple numeric workspaces 1…10
ctrl-right = 'exec-and-forget ${BASH_PATH} set-workspace.sh next'
ctrl-left = 'exec-and-forget ${BASH_PATH} set-workspace.sh prev'

ctrl-1 = 'workspace 1'
ctrl-2 = 'workspace 2'
ctrl-3 = 'workspace 3'
ctrl-4 = 'workspace 4'
ctrl-5 = 'workspace 5'
ctrl-6 = 'workspace 6'
ctrl-7 = 'workspace 7'
ctrl-8 = 'workspace 8'
ctrl-9 = 'workspace 9'
ctrl-0 = 'workspace 10'

# Move focused window
shift-cmd-1 = ['move-node-to-workspace 1', 'workspace 1']
shift-cmd-2 = ['move-node-to-workspace 2', 'workspace 2']
shift-cmd-3 = ['move-node-to-workspace 3', 'workspace 3']
shift-cmd-4 = ['move-node-to-workspace 4', 'workspace 4']
shift-cmd-5 = ['move-node-to-workspace 5', 'workspace 5']
shift-cmd-6 = ['move-node-to-workspace 6', 'workspace 6']
shift-cmd-7 = ['move-node-to-workspace 7', 'workspace 7']
shift-cmd-8 = ['move-node-to-workspace 8', 'workspace 8']
shift-cmd-9 = ['move-node-to-workspace 9', 'workspace 9']
shift-cmd-0 = ['move-node-to-workspace 10', 'workspace 10']

shift-cmd-ctrl-1 = 'move-node-to-workspace 1'
shift-cmd-ctrl-2 = 'move-node-to-workspace 2'
shift-cmd-ctrl-3 = 'move-node-to-workspace 3'
shift-cmd-ctrl-4 = 'move-node-to-workspace 4'
shift-cmd-ctrl-5 = 'move-node-to-workspace 5'
shift-cmd-ctrl-6 = 'move-node-to-workspace 6'
shift-cmd-ctrl-7 = 'move-node-to-workspace 7'
shift-cmd-ctrl-8 = 'move-node-to-workspace 8'
shift-cmd-ctrl-9 = 'move-node-to-workspace 9'
shift-cmd-ctrl-0 = 'move-node-to-workspace 10'

# Keep your Rectangle helpers
ctrl-cmd-o = 'exec-and-forget open -g "rectangle://execute-action?name=maximize"'
cmd-alt-o = 'exec-and-forget open -g "rectangle://execute-action?name=maximize"'
cmd-alt-p = 'exec-and-forget open -g "rectangle://execute-action?name=maximize"'
cmd-alt-i = 'exec-and-forget open -g "rectangle://execute-action?name=maximize"'
cmd-alt-k = 'exec-and-forget open -g "rectangle://execute-action?name=left"'
cmd-alt-l = 'exec-and-forget open -g "rectangle://execute-action?name=bottom"'
cmd-alt-semicolon = 'exec-and-forget open -g "rectangle://execute-action?name=right"'

cmd-backtick = 'exec-and-forget ${BASH_PATH} cycle-app-windows-in-workspace.sh next'
cmd-shift-backtick = 'exec-and-forget ${BASH_PATH} cycle-app-windows-in-workspace.sh prev'

# Manual toggle back to desktop if needed
shift-cmd-ctrl-t = [
    'mode desktop',
    'exec-and-forget ${BASH_PATH} migrate-workspaces.sh desktop',
]

# QoL
shift-cmd-ctrl-c = "reload-config"

# ===== Desktop (3-monitor) mode =====
[mode.desktop.binding]

# Save/restore layout
shift-cmd-ctrl-s = 'exec-and-forget ${BASH_PATH} aerospace-save-restore.sh save'
shift-cmd-ctrl-r = 'exec-and-forget ${BASH_PATH} aerospace-save-restore.sh restore'

# Unified workspace: next/prev
ctrl-right = 'exec-and-forget ${BASH_PATH} set-workspace.sh next'
ctrl-left = 'exec-and-forget ${BASH_PATH} set-workspace.sh prev'

# Switch unified workspace (Ctrl+1..10)
# ctrl-1 = ["workspace 1L",  "workspace 1C",  "workspace 1R",]
# ctrl-2 = ["workspace 2L",  "workspace 2C",  "workspace 2R",]
# ctrl-3 = ["workspace 3L",  "workspace 3C",  "workspace 3R",]
# ctrl-4 = ["workspace 4L",  "workspace 4C",  "workspace 4R",]
# ctrl-5 = ["workspace 5L",  "workspace 5C",  "workspace 5R",]
# ctrl-6 = ["workspace 6L",  "workspace 6C",  "workspace 6R",]
# ctrl-7 = ["workspace 7L",  "workspace 7C",  "workspace 7R",]
# ctrl-8 = ["workspace 8L",  "workspace 8C",  "workspace 8R",]
# ctrl-9 = ["workspace 9L",  "workspace 9C",  "workspace 9R",]
# ctrl-0 = ["workspace 10L", "workspace 10C", "workspace 10R"]
ctrl-1  = "exec-and-forget set-workspace.sh 1"
ctrl-2  = "exec-and-forget set-workspace.sh 2"
ctrl-3  = "exec-and-forget set-workspace.sh 3"
ctrl-4  = "exec-and-forget set-workspace.sh 4"
ctrl-5  = "exec-and-forget set-workspace.sh 5"
ctrl-6  = "exec-and-forget set-workspace.sh 6"
ctrl-7  = "exec-and-forget set-workspace.sh 7"
ctrl-8  = "exec-and-forget set-workspace.sh 8"
ctrl-9  = "exec-and-forget set-workspace.sh 9"
ctrl-0  = "exec-and-forget set-workspace.sh 10"

# Throw focused window (Shift+Alt+1..10)
shift-cmd-1 = 'exec-and-forget ${BASH_PATH} desktop__move-node-to-workspace-and-follow.sh 1'
shift-cmd-2 = 'exec-and-forget ${BASH_PATH} desktop__move-node-to-workspace-and-follow.sh 2'
shift-cmd-3 = 'exec-and-forget ${BASH_PATH} desktop__move-node-to-workspace-and-follow.sh 3'
shift-cmd-4 = 'exec-and-forget ${BASH_PATH} desktop__move-node-to-workspace-and-follow.sh 4'
shift-cmd-5 = 'exec-and-forget ${BASH_PATH} desktop__move-node-to-workspace-and-follow.sh 5'
shift-cmd-6 = 'exec-and-forget ${BASH_PATH} desktop__move-node-to-workspace-and-follow.sh 6'
shift-cmd-7 = 'exec-and-forget ${BASH_PATH} desktop__move-node-to-workspace-and-follow.sh 7'
shift-cmd-8 = 'exec-and-forget ${BASH_PATH} desktop__move-node-to-workspace-and-follow.sh 8'
shift-cmd-9 = 'exec-and-forget ${BASH_PATH} desktop__move-node-to-workspace-and-follow.sh 9'
shift-cmd-0 = 'exec-and-forget ${BASH_PATH} desktop__move-node-to-workspace-and-follow.sh 10'

# Throw (no follow)
shift-cmd-ctrl-1 = 'exec-and-forget ${BASH_PATH} desktop__move-node-to-workspace.sh 1'
shift-cmd-ctrl-2 = 'exec-and-forget ${BASH_PATH} desktop__move-node-to-workspace.sh 2'
shift-cmd-ctrl-3 = 'exec-and-forget ${BASH_PATH} desktop__move-node-to-workspace.sh 3'
shift-cmd-ctrl-4 = 'exec-and-forget ${BASH_PATH} desktop__move-node-to-workspace.sh 4'
shift-cmd-ctrl-5 = 'exec-and-forget ${BASH_PATH} desktop__move-node-to-workspace.sh 5'
shift-cmd-ctrl-6 = 'exec-and-forget ${BASH_PATH} desktop__move-node-to-workspace.sh 6'
shift-cmd-ctrl-7 = 'exec-and-forget ${BASH_PATH} desktop__move-node-to-workspace.sh 7'
shift-cmd-ctrl-8 = 'exec-and-forget ${BASH_PATH} desktop__move-node-to-workspace.sh 8'
shift-cmd-ctrl-9 = 'exec-and-forget ${BASH_PATH} desktop__move-node-to-workspace.sh 9'
shift-cmd-ctrl-0 = 'exec-and-forget ${BASH_PATH} desktop__move-node-to-workspace.sh 10'

# Rectangle helpers and monitor cycling
ctrl-cmd-o = 'exec-and-forget open -g "rectangle://execute-action?name=maximize"'
cmd-alt-o = [
    'move-node-to-monitor next --focus-follows-window --wrap-around',
    'exec-and-forget open -g "rectangle://execute-action?name=maximize"',
]
cmd-alt-p = [
    'move-node-to-monitor right --focus-follows-window --wrap-around',
    'exec-and-forget open -g "rectangle://execute-action?name=maximize"',
]
cmd-alt-i = [
    'move-node-to-monitor left --focus-follows-window --wrap-around',
    'exec-and-forget open -g "rectangle://execute-action?name=maximize"',
]
cmd-alt-k = [
    'move-node-to-monitor prev --focus-follows-window --wrap-around',
    'exec-and-forget open -g "rectangle://execute-action?name=left"',
]
cmd-alt-l = [
    'move-node-to-monitor prev --focus-follows-window --wrap-around',
    'exec-and-forget open -g "rectangle://execute-action?name=maximize"',
]
cmd-alt-semicolon = [
    'move-node-to-monitor next --focus-follows-window --wrap-around',
    'exec-and-forget open -g "rectangle://execute-action?name=right"',
]

cmd-backtick = 'exec-and-forget ${BASH_PATH} cycle-app-windows-in-workspace.sh next'
cmd-shift-backtick = 'exec-and-forget ${BASH_PATH} cycle-app-windows-in-workspace.sh prev'

# Manual toggle to main mode if you ever need it
shift-cmd-ctrl-t = ['mode main', 'exec-and-forget ${BASH_PATH} migrate-workspaces.sh main']

# QoL
shift-cmd-ctrl-c = "reload-config"
