#!/bin/bash

if [[ -z "$1"  ]]; then
  echo "Must provide the name of an environment" 1>&2
  exit 1
fi

if [[ -z "$2"  ]]; then
  PYTHON_VERSION="3.8"
else
  PYTHON_VERSION="$2"
fi

set -u

CONDA_PATH="$HOME/miniconda3"

CONDA_PACKAGES="python=$PYTHON_VERSION jupyterlab scipy numpy pandas"
PIP_PACKAGES="black blackcellmagic"
EXTENSIONS="@jupyter-widgets/jupyterlab-manager jupyterlab_vim @pyviz/jupyterlab_pyviz @jupyterlab/toc"

BASE_BIN="$CONDA_PATH/bin"
ENV_BIN="$CONDA_PATH/envs/$1/bin"

$BASE_BIN/conda install -y $CONDA_PACKAGES && \
  $ENV_BIN/python -m pip install $PIP_PACKAGES && \
  $ENV_BIN/jupyter labextension install $EXTENSIONS
